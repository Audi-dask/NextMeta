1. 准备测试数据 (Setup)
请在你的数据库客户端（如 Navicat, DBeaver 或命令行）中执行以下 SQL，创建一个测试表并生成 10,000 条数据。



```sql
-- 创建测试表
CREATE TABLE IF NOT EXISTS `test_orders` (
  `id` int NOT NULL AUTO_INCREMENT,
  `user_id` int NOT NULL,
  `amount` decimal(10,2) NOT NULL,
  `status` varchar(20) NOT NULL,
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 生成 10,000 条测试数据 (使用存储过程)
DROP PROCEDURE IF EXISTS generate_test_data;
DELIMITER ;;
CREATE PROCEDURE generate_test_data()
BEGIN
  DECLARE i INT DEFAULT 0;
  WHILE i < 10000 DO
    INSERT INTO test_orders (user_id, amount, status, created_at) 
    VALUES (
      FLOOR(1 + RAND() * 1000), 
      ROUND(RAND() * 1000, 2), 
      ELT(FLOOR(1 + RAND() * 3), 'pending', 'paid', 'shipped'),
      NOW() - INTERVAL FLOOR(RAND() * 365) DAY
    );
    SET i = i + 1;
  END WHILE;
END;;
DELIMITER ;

CALL generate_test_data();
```








```markdown
2. 测试流程 (Test Flow)
请先前往 系统设置 (System Settings)，将 工单影响行数安全阈值 设置为 1000 (为了更容易触发警告)。

场景 A: DDL 操作 (Schema Change)
在工单创建页面输入以下 SQL。 预期结果: 预检弹窗显示类型为 DDL，并提示“高危警告：Schema Change”，需要勾选确认框才能强制提交。

sql
ALTER TABLE `test_orders` ADD COLUMN `updated_at` datetime DEFAULT NULL;
场景 B: 高危 DML 操作 (超过阈值)
在工单创建页面输入以下 SQL (这将影响约 3300 行，超过 1000 的阈值)。 预期结果: 预检弹窗显示 预计影响行数 约为 3300+，触发红色高危警告，需要勾选确认框才能强制提交。

sql
UPDATE test_orders SET status = 'completed' WHERE status = 'paid';
场景 C: 安全 DML 操作 (低于阈值)
在工单创建页面输入以下 SQL (仅影响 1 行)。 预期结果: 预检弹窗显示 预计影响行数 为 1，显示绿色“在安全阈值内”，可直接提交。

sql
UPDATE test_orders SET status = 'closed' WHERE id = 1;
```
